Index: src/com/lizhuo/tankgame4/MyPanel.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.lizhuo.tankgame4;\r\n\r\nimport javax.swing.*;\r\nimport java.awt.*;\r\nimport java.awt.event.KeyEvent;\r\nimport java.awt.event.KeyListener;\r\nimport java.util.Vector;\r\n\r\n\r\n/**\r\n * 坦克大战的绘图区域（画板）\r\n */\r\n//为了响应键盘事件，实现keyListener\r\n//为了让Panel 不停的重绘子弹, 需要将 MyPanel 实现 Runnable 接口, 当作一个线程使用\r\npublic class MyPanel extends JPanel implements KeyListener, Runnable {\r\n    //定义我的坦克\r\n    Hero hero = null;\r\n    //定义敌人坦克, 方到Vector中为了线程安全\r\n    Vector<EnemyTank> enemyTanks = new Vector<>();\r\n    int enemyTanksSize = 3;    //初始敌人坦克数量\r\n    //说明: 当子弹击中坦克时, 加入一个Bomb对象到bombs\r\n    Vector<Bomb> bombs = new Vector<>();    //定义一个Vector, 用于存放炸弹\r\n\r\n    //定义三张炸弹图片， 用于显示爆炸效果\r\n    Image image1 = null;\r\n    Image image2 = null;\r\n    Image image3 = null;\r\n\r\n    public MyPanel() {\r\n        this.hero = new Hero(100, 100);    //初始化自己的坦克\r\n        hero.setSpeed(1);    //设置坦克速度, 默认是1;\r\n        //初始化敌人坦克\r\n        for (int i = 0; i < enemyTanksSize; i++) {\r\n            //创建一个敌人坦克\r\n            EnemyTank enemyTank = new EnemyTank(100 * (i + 1), 0);\r\n            //设置方向\r\n            enemyTank.setDirect(2);\r\n            //启动敌人坦克线程, 让他动起来\r\n            new Thread(enemyTank).start();\r\n            //给该enemyTank加入一颗子弹\r\n            Shot shot = new Shot(enemyTank.getX() + 20, enemyTank.getY() + 60, enemyTank.getDirect());\r\n            //加入enemyTank的Vector成员\r\n            enemyTank.shots.add(shot);\r\n            //启动shot对象\r\n            new Thread(shot).start();\r\n            //加入\r\n            enemyTanks.add(enemyTank);\r\n        }\r\n        //初始化图片对象\r\n        image1 = Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(\"/bomb_1.gif\"));\r\n        image2 = Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(\"/bomb_2.gif\"));\r\n        image3 = Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(\"/bomb_3.gif\"));\r\n\r\n    }\r\n\r\n    @Override\r\n    @SuppressWarnings(\"all\")\r\n    public void paint(Graphics g) {\r\n        super.paint(g);\r\n        g.fillRect(0, 0, 1000, 750);    //填充矩形，默认是黑色\r\n        //画出坦克-封装方法\r\n        drawTank(hero.getX(), hero.getY(), g, hero.getDirect(), 1);    //画出我方坦克\r\n\r\n        for (EnemyTank enemyTank : enemyTanks) {    //画出敌人坦克\r\n            //判断当前坦克是否还存活\r\n            if (enemyTank.isLive) {\r\n                drawTank(enemyTank.getX(), enemyTank.getY(), g, enemyTank.getDirect(), 0);\r\n                //画出 enemyTank 所有的子弹\r\n                for (int i = 0; i < enemyTank.shots.size(); i++) {\r\n                    //取出子弹\r\n                    Shot shot = enemyTank.shots.get(i);\r\n                    //绘制\r\n                    if (shot.isLive) {\r\n                        g.draw3DRect(shot.x, shot.y, 1, 1, false);\r\n                    } else {\r\n                        //从Vector移除\r\n                        enemyTank.shots.remove(shot);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        //画出hero射击的子弹\r\n//        if (hero.shot != null && hero.shot.isLive == true) {\r\n//            g.draw3DRect(hero.shot.x, hero.shot.y, 1, 1, false);\r\n//        }\r\n        //将hero的子弹集合shots遍历绘制出来\r\n        for (int i = 0; i < hero.shots.size(); i++) {\r\n            Shot shot = hero.shots.get(i);\r\n            if (hero.shot != null && hero.shot.isLive) {\r\n                g.draw3DRect(hero.shot.x, hero.shot.y, 1, 1, false);\r\n            } else {    //如果该手套对象已经无效, 就从shots集合中拿掉\r\n                hero.shots.remove(shot);\r\n            }\r\n        }\r\n\r\n        //如果bombs中 有对象, 就画出\r\n        for (int i = 0; i < bombs.size(); i++) {\r\n            //取出炸弹\r\n            Bomb bomb = bombs.get(i);\r\n            //根据当前这个bomb对象的life值去画出对应的图片\r\n            if (bomb.life > 6) {\r\n                g.drawImage(image1, bomb.x, bomb.y, 60, 60, this);\r\n            } else if (bomb.life > 3) {\r\n                g.drawImage(image1, bomb.x, bomb.y, 60, 60, this);\r\n            } else {\r\n                g.drawImage(image1, bomb.x, bomb.y, 60, 60, this);\r\n            }\r\n            //让炸弹的生命值减少\r\n            bomb.lifeDown();\r\n            //如果炸弹的生命值为0, 就从bombs的集合中删除\r\n            if (bomb.life == 0) {\r\n                bombs.remove(bomb);\r\n            }\r\n\r\n\r\n        }\r\n    }\r\n\r\n    //编写方法，画出坦克\r\n\r\n    /**\r\n     * @param x      坦克的左上角x坐标\r\n     * @param y      坦克的左上角y坐标\r\n     * @param g      画笔\r\n     * @param direct 坦克的方向\r\n     * @param type   坦克类型 (用颜色标记我的坦克，还是敌人的坦克)\r\n     */\r\n    @SuppressWarnings(\"all\")\r\n    public void drawTank(int x, int y, Graphics g, int direct, int type) {\r\n        switch (type) {\r\n            case 0:    //敌方坦克\r\n                g.setColor(Color.cyan);\r\n                break;\r\n            case 1:    //我方坦克\r\n                g.setColor(Color.yellow);\r\n                break;\r\n\r\n        }\r\n\r\n        switch (direct) {\r\n            case 0: //表示向上\r\n                g.fill3DRect(x, y, 10, 60, false);//画出坦克左边轮子\r\n                g.fill3DRect(x + 30, y, 10, 60, false);//画出坦克右边轮子\r\n                g.fill3DRect(x + 10, y + 10, 20, 40, false);//画出坦克盖子\r\n                g.fillOval(x + 10, y + 20, 20, 20);//画出圆形盖子\r\n                g.drawLine(x + 20, y + 30, x + 20, y);//画出炮筒\r\n                break;\r\n            case 1: //表示向右\r\n                g.fill3DRect(x, y, 60, 10, false);//画出坦克上边轮子\r\n                g.fill3DRect(x, y + 30, 60, 10, false);//画出坦克下边轮子\r\n                g.fill3DRect(x + 10, y + 10, 40, 20, false);//画出坦克盖子\r\n                g.fillOval(x + 20, y + 10, 20, 20);//画出圆形盖子\r\n                g.drawLine(x + 30, y + 20, x + 60, y + 20);//画出炮筒\r\n                break;\r\n            case 2: //表示向下\r\n                g.fill3DRect(x, y, 10, 60, false);//画出坦克左边轮子\r\n                g.fill3DRect(x + 30, y, 10, 60, false);//画出坦克右边轮子\r\n                g.fill3DRect(x + 10, y + 10, 20, 40, false);//画出坦克盖子\r\n                g.fillOval(x + 10, y + 20, 20, 20);//画出圆形盖子\r\n                g.drawLine(x + 20, y + 30, x + 20, y + 60);//画出炮筒\r\n                break;\r\n            case 3: //表示向左\r\n                g.fill3DRect(x, y, 60, 10, false);//画出坦克上边轮子\r\n                g.fill3DRect(x, y + 30, 60, 10, false);//画出坦克下边轮子\r\n                g.fill3DRect(x + 10, y + 10, 40, 20, false);//画出坦克盖子\r\n                g.fillOval(x + 20, y + 10, 20, 20);//画出圆形盖子\r\n                g.drawLine(x + 30, y + 20, x, y + 20);//画出炮筒\r\n                break;\r\n            default:\r\n                System.out.println(\"暂时不处理\");\r\n\r\n        }\r\n    }\r\n\r\n    //编写方法，判断我方的子弹是否击中敌人\r\n    //最好在run方法中判断\r\n    public void hitTank(Shot s, EnemyTank enemyTank) {\r\n        //判断子弹集中坦克\r\n        switch (enemyTank.getDirect()) {\r\n            case 0:    //坦克向上\r\n            case 2:    //坦克向下\r\n                if (s.x > enemyTank.getX() && s.x < enemyTank.getX() + 40 &&\r\n                        s.y > enemyTank.getY() && s.y < enemyTank.getY() + 60) {\r\n                    s.isLive = false;\r\n                    enemyTank.isLive = false;\r\n                    //当我的子弹击中敌人坦克后, 将enemyTank 从Vector中拿掉\r\n                    enemyTanks.remove(enemyTank);\r\n                    //创建Bomb对象, 加入到bombs中\r\n                    Bomb bomb = new Bomb(enemyTank.getX(), enemyTank.getY());\r\n                    bombs.add(bomb);\r\n                }\r\n                break;\r\n            case 1:    //坦克向右\r\n            case 3:    //坦克向左\r\n                if (s.x > enemyTank.getX() && s.x < enemyTank.getX() + 60 &&\r\n                        s.y > enemyTank.getY() && s.y < enemyTank.getY() + 40) {\r\n                    s.isLive = false;\r\n                    enemyTank.isLive = false;\r\n                    //当我的子弹击中敌人坦克后, 将enemyTank 从Vector中拿掉\r\n                    enemyTanks.remove(enemyTank);\r\n                    //创建Bomb对象, 加入到bombs中\r\n                    Bomb bomb = new Bomb(enemyTank.getX(), enemyTank.getY());\r\n                    bombs.add(bomb);\r\n                }\r\n                break;\r\n        }\r\n\r\n    }\r\n\r\n    @Override\r\n    public void keyTyped(KeyEvent e) {\r\n\r\n    }\r\n\r\n    //处理wsad按下的情况\r\n\r\n    @Override\r\n    @SuppressWarnings(\"all\")\r\n    public void keyPressed(KeyEvent e) {\r\n        if (e.getExtendedKeyCode() == KeyEvent.VK_W) {    //按下W键\r\n            //改变坦克的方向\r\n            hero.setDirect(0);\r\n            //修改坦克的坐标\r\n            if (hero.getY() > 0) {\r\n                hero.moveUp();\r\n            }\r\n\r\n        } else if (e.getExtendedKeyCode() == KeyEvent.VK_D) {    //按下D键\r\n            //改变坦克的方向\r\n            hero.setDirect(1);\r\n            if (hero.getX() + 60 < 1000) {\r\n                hero.moveRight();\r\n            }\r\n        } else if (e.getExtendedKeyCode() == KeyEvent.VK_S) {    //按下S键\r\n            //改变坦克的方向\r\n            hero.setDirect(2);\r\n            if (hero.getY() + 60 < 750) {\r\n                hero.moveDown();\r\n            }\r\n        } else if (e.getExtendedKeyCode() == KeyEvent.VK_A) {    //按下A键\r\n            //改变坦克的方向\r\n            hero.setDirect(3);\r\n            if (hero.getX() > 0) {\r\n                hero.moveLeft();\r\n            }\r\n        }\r\n\r\n        //如果用户按下的时J, 就发射\r\n        if (e.getExtendedKeyCode() == KeyEvent.VK_J) {\r\n//            //发射一颗子弹\r\n//            //判断hero的子弹是否销毁 第一次为空才触发子弹, 第二次使用判断子弹打到边界没有存活才触发\r\n//            if (hero.shot == null || !hero.shot.isLive) {\r\n//                hero.shotEnemyTank();\r\n//            }\r\n            //发射多颗子弹\r\n            hero.shotEnemyTank();\r\n        }\r\n        this.repaint();\r\n    }\r\n\r\n    @Override\r\n    public void keyReleased(KeyEvent e) {\r\n\r\n    }\r\n\r\n    @Override\r\n    public void run() {     //每隔 100毫秒, 重绘区域, 刷新绘图区域, 子弹就移动\r\n        while (true) {\r\n            try {\r\n                Thread.sleep(100);\r\n            } catch (InterruptedException e) {\r\n                e.printStackTrace();\r\n            }\r\n            //判断是否集中了敌人坦克\r\n            if (hero.shot != null && hero.shot.isLive) {    //当我的子弹还存活\r\n                //遍历敌人所有的坦克\r\n                for (int i = 0; i < enemyTanks.size(); i++) {\r\n                    EnemyTank enemyTank = enemyTanks.get(i);\r\n                    hitTank(hero.shot, enemyTank);\r\n                }\r\n            }\r\n\r\n            this.repaint();\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/com/lizhuo/tankgame4/MyPanel.java	(revision 5ddd4cd2963919baba5ff18177d99141a6b7f56b)
+++ src/com/lizhuo/tankgame4/MyPanel.java	(date 1712370224080)
@@ -81,17 +81,8 @@
         }
 
         //画出hero射击的子弹
-//        if (hero.shot != null && hero.shot.isLive == true) {
-//            g.draw3DRect(hero.shot.x, hero.shot.y, 1, 1, false);
-//        }
-        //将hero的子弹集合shots遍历绘制出来
-        for (int i = 0; i < hero.shots.size(); i++) {
-            Shot shot = hero.shots.get(i);
-            if (hero.shot != null && hero.shot.isLive) {
-                g.draw3DRect(hero.shot.x, hero.shot.y, 1, 1, false);
-            } else {    //如果该手套对象已经无效, 就从shots集合中拿掉
-                hero.shots.remove(shot);
-            }
+        if (hero.shot != null && hero.shot.isLive == true) {
+            g.draw3DRect(hero.shot.x, hero.shot.y, 1, 1, false);
         }
 
         //如果bombs中 有对象, 就画出
@@ -248,13 +239,10 @@
 
         //如果用户按下的时J, 就发射
         if (e.getExtendedKeyCode() == KeyEvent.VK_J) {
-//            //发射一颗子弹
-//            //判断hero的子弹是否销毁 第一次为空才触发子弹, 第二次使用判断子弹打到边界没有存活才触发
-//            if (hero.shot == null || !hero.shot.isLive) {
-//                hero.shotEnemyTank();
-//            }
-            //发射多颗子弹
-            hero.shotEnemyTank();
+            //判断hero的子弹是否销毁 第一次为空才触发子弹, 第二次使用判断子弹打到边界没有存活才触发
+            if (hero.shot == null || !hero.shot.isLive) {
+                hero.shotEnemyTank();
+            }
         }
         this.repaint();
     }
